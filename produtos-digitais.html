<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Currículo - ResolveFácil</title>
    <meta name="description" content="Crie um currículo profissional em minutos. Escolha entre um modelo simples e gratuito ou um modelo profissional avançado.">
    <link rel="icon" href="favicon.png" type="image/png">
    
    <link rel="stylesheet" href="fontawesome/css/all.min.css">
    
    <style>
        /* === VARIÁVEIS DE COR E ESTILOS GLOBAIS === */
        :root {
            --primary-bg: #003459;
            --secondary-bg: #3e5a6a;
            --text-color: #f2f2ed;
            --highlight: #ff6600;
            --button-hover: #ff4400;
            --whatsapp-button: #25d366;
            --body-bg-servicos: #f2f2ed;
            --body-text-servicos: #3e5a6a;
            --card-bg: #ffffff;
            --input-border: #cccccc;
            --input-focus-border: #003459;
            --danger-color: #d9534f;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            background-color: var(--body-bg-servicos);
            color: var(--body-text-servicos);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* === HEADER E NAVEGAÇÃO (Padrão do site) === */
        header { 
            background-color: var(--secondary-bg); 
            padding: 10px 0; 
            position: sticky; 
            top: 0; 
            width: 100%; 
            z-index: 1000; 
        }
        .nav-container { 
            max-width: 1000px; 
            margin: auto; 
            display: flex; 
            align-items: center; 
            justify-content: space-between; 
            padding: 0 20px; 
        }
        .logo-area { 
            display: flex; 
            align-items: center; 
            gap: 10px; 
            text-decoration: none; 
            color: var(--text-color); 
        }
        .logo-area img { 
            width: 40px; 
            height: 40px; 
            border-radius: 50%; 
        }
        .logo-area span { 
            font-size: 1.4em; 
            font-weight: bold; 
        }
        
        #menu-container nav ul { 
            display: flex; 
            gap: 20px; 
            list-style: none; 
        }
        #menu-container nav a { 
            color: var(--text-color); 
            text-decoration: none; 
            font-weight: bold; 
            font-size: 1em; 
            padding: 5px 0; 
            transition: color 0.3s; 
        }
        #menu-container nav a:hover { 
            color: var(--highlight); 
        }

        .hamburger { 
            display: none; 
            flex-direction: column; 
            cursor: pointer; 
            gap: 5px; 
            transition: all 0.3s ease-in-out; 
        }
        .hamburger span { 
            display: block; 
            height: 3px; 
            width: 25px; 
            background-color: var(--text-color); 
            border-radius: 3px; 
            transition: all 0.3s ease-in-out; 
        }
        
        .mobile-nav { 
            display: none; 
            flex-direction: column; 
            position: fixed; 
            top: 60px; 
            right: 0; 
            background: var(--secondary-bg); 
            width: 70%; 
            max-width: 300px; 
            height: 100%; 
            padding: 30px 20px; 
            z-index: 999; 
            transform: translateX(100%); 
            transition: transform 0.3s ease-out; 
        }
        .mobile-nav.show { 
            display: flex; 
            transform: translateX(0); 
        }
        .mobile-nav a { 
            color: var(--text-color); 
            text-decoration: none; 
            margin: 15px 0; 
            font-weight: bold; 
            font-size: 1.2em; 
            transition: color 0.3s; 
        }
        .mobile-nav a:hover { 
            color: var(--highlight); 
        }

        main {
            flex: 1;
            padding: 20px;
        }
        
        /* === CONTAINER PRINCIPAL DO GERADOR === */
        .generator-container {
            max-width: 900px;
            margin: 20px auto;
            background-color: var(--card-bg);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
        }

        .generator-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .generator-header h1 {
            font-size: clamp(1.8em, 5vw, 2.5em);
            color: var(--primary-bg);
            margin-bottom: 10px;
        }

        .generator-header p {
            font-size: 1.1em;
            color: var(--secondary-bg);
        }

        /* === SELETOR DE MODELO (Simples vs Profissional) === */
        .model-selector {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .model-option {
            padding: 15px 25px;
            border: 2px solid var(--input-border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            flex: 1;
            max-width: 300px;
        }
        
        .model-option i {
            font-size: 1.5em;
            margin-bottom: 8px;
            color: var(--secondary-bg);
        }

        .model-option h3 {
            font-size: 1.1em;
            color: var(--primary-bg);
            margin-bottom: 5px;
        }

        .model-option p {
            font-size: 0.9em;
            color: var(--body-text-servicos);
        }

        .model-option.selected {
            border-color: var(--highlight);
            background-color: #fff7f0;
            transform: translateY(-3px);
            box-shadow: 0 4px 10px rgba(255, 102, 0, 0.15);
        }
        
        .model-option.selected i, .model-option.selected h3 {
            color: var(--highlight);
        }

        /* === ESTILOS DO FORMULÁRIO === */
        .form-section {
            margin-bottom: 30px;
            border-bottom: 1px solid #eee;
            padding-bottom: 20px;
        }
        
        .form-section:last-of-type {
            border-bottom: none;
        }

        .form-section h2 {
            font-size: 1.5em;
            color: var(--primary-bg);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-section h2 i {
            color: var(--highlight);
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
        }
        
        .form-group input[type="text"],
        .form-group input[type="email"],
        .form-group input[type="tel"],
        .form-group input[type="url"],
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--input-border);
            border-radius: 6px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .form-group input:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--input-focus-border);
        }

        .professional-only {
            display: none;
        }

        #photo-upload-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 190px;
            text-align: center;
            border: 2px dashed var(--input-border);
            border-radius: 8px;
            padding: 20px;
            cursor: pointer;
            transition: border-color 0.3s, background-color 0.3s;
        }
        #photo-upload-wrapper:hover {
            border-color: var(--highlight);
            background-color: #fefafa;
        }
        #photo-upload-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            color: var(--body-text-servicos);
        }
        #photo-upload-placeholder i {
            font-size: 2.5em;
            color: var(--secondary-bg);
        }
        #photo-preview {
            max-width: 150px;
            max-height: 150px;
            border-radius: 50%;
            display: none;
            object-fit: cover;
        }
        #photo {
            display: none;
        }

        .dynamic-item {
            background-color: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            position: relative;
        }

        .remove-item-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--danger-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .add-item-btn {
            background-color: var(--secondary-bg);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.3s;
            font-weight: bold;
        }
        .add-item-btn:hover {
            background-color: var(--primary-bg);
        }

        .generator-footer {
            text-align: center;
            margin-top: 30px;
        }

        .generate-btn {
            background-color: var(--highlight);
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .generate-btn:hover {
            background-color: var(--button-hover);
            transform: translateY(-3px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .generate-btn:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        .modal-content h3 {
            color: var(--primary-bg);
            margin-bottom: 15px;
        }
        .modal-content p {
            margin-bottom: 20px;
        }
        #modal-email-input {
             width: 100%;
            padding: 12px;
            border: 1px solid var(--input-border);
            border-radius: 6px;
            font-size: 1em;
            margin-bottom: 20px;
        }
        .modal-actions {
            display: flex;
            gap: 15px;
        }
        .modal-btn {
            flex: 1;
            padding: 12px;
            border-radius: 6px;
            border: none;
            font-weight: bold;
            cursor: pointer;
        }
        #modal-confirm-btn {
            background-color: var(--whatsapp-button);
            color: white;
        }
        #modal-cancel-btn {
            background-color: #eee;
        }

        #preview-modal .modal-content {
            max-width: 900px;
            width: 100%;
        }
        #preview-area {
            width: 100%;
            height: 60vh;
            border: 1px solid #ccc;
            overflow: hidden;
            margin-bottom: 20px;
            transform-origin: top center;
        }
        #preview-area > div {
            transform: scale(0.4); 
            transform-origin: top center;
        }

        .security-seals-section {
            background-color: var(--body-bg-servicos);
            padding: 40px 20px 0;
            text-align: center;
        }
        .security-seals-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 25px;
            flex-wrap: wrap;
        }
        .security-seals-container img {
            height: 50px;
            width: auto;
            object-fit: contain;
        }
        .social-icons {
            background-color: var(--body-bg-servicos);
            text-align: center;
            padding: 30px 20px;
        }
        .social-icons-wrapper {
            display: flex;
            justify-content: center;
            gap: 25px;
        }
        .social-icons a {
            text-decoration: none;
            display: inline-block;
            transition: transform 0.3s;
            color: var(--body-text-servicos);
        }
        .social-icons a:hover {
            transform: scale(1.2);
        }
        .social-icons .fab {
            font-size: 2.5em;
        }
        .social-icons .fa-instagram:hover { color: #C13584; }
        .social-icons .fa-facebook:hover { color: #1877F2; }
        .social-icons .fa-whatsapp:hover { color: var(--whatsapp-button); }

        footer {
            background-color: var(--secondary-bg);
            color: var(--text-color);
            text-align: center;
            padding: 20px;
            font-size: 0.9em;
            margin-top: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        footer a {
            color: var(--text-color);
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }
        footer a:hover {
            color: var(--highlight);
        }
        
        #template-storage {
            display: none;
        }

        .pdf-template-base {
            font-family: 'Helvetica', Arial, sans-serif;
            color: #333;
            width: 210mm;
            background: white;
        }
        
        .pdf-template-base * {
            box-sizing: border-box;
        }

        .simple-template {
            min-height: 297mm;
            padding: 15mm;
        }
        .simple-template .header { text-align: center; margin-bottom: 10mm; }
        .simple-template .name { font-size: 28pt; font-weight: bold; color: #333; margin-bottom: 2mm; }
        .simple-template .contact-info { font-size: 10pt; color: #555; }
        .simple-template .section-title { font-size: 14pt; font-weight: bold; color: var(--primary-bg); border-bottom: 2px solid var(--primary-bg); padding-bottom: 1mm; margin-top: 8mm; margin-bottom: 4mm; }
        .simple-template .content, .simple-template .skills-list { font-size: 11pt; line-height: 1.5; }
        .simple-template .job-title { font-size: 12pt; font-weight: bold; }
        .simple-template .job-details { font-size: 10pt; color: #666; margin-bottom: 2mm; }
        .simple-template .job-description { font-size: 11pt; }
        .simple-template .item { margin-bottom: 6mm; }

        .professional-template {
            min-height: 297mm;
            display: flex;
        }
        .professional-template .sidebar {
            width: 70mm;
            background-color: var(--primary-bg);
            color: white;
            padding: 15mm;
        }
        .professional-template .main-content {
            width: 140mm;
            padding: 15mm;
        }
        .professional-template .profile-photo {
            width: 40mm;
            height: 40mm;
            border-radius: 50%;
            object-fit: cover;
            margin: 0 auto 8mm;
            display: block;
            border: 3px solid white;
        }
        .professional-template .sidebar .section-title {
            font-size: 13pt;
            font-weight: bold;
            color: var(--highlight);
            margin-top: 8mm;
            margin-bottom: 4mm;
            border-bottom: 1px solid var(--highlight);
            padding-bottom: 2mm;
        }
        .professional-template .sidebar .contact-item {
            display: flex;
            align-items: center;
            gap: 3mm;
            margin-bottom: 3mm;
            font-size: 9pt;
        }
        .professional-template .sidebar .contact-item a {
            color: white;
            text-decoration: none;
            word-break: break-all;
        }
        .professional-template .sidebar .contact-item i {
            width: 4mm;
            text-align: center;
        }
        .professional-template .sidebar .skill-item, .professional-template .sidebar .lang-item {
            font-size: 10pt;
            margin-bottom: 2mm;
        }
        .professional-template .main-content .name {
            font-size: 28pt;
            font-weight: bold;
            color: var(--primary-bg);
            margin-bottom: 2mm;
        }
        .professional-template .main-content .section-title {
            font-size: 14pt;
            font-weight: bold;
            color: var(--primary-bg);
            border-bottom: 2px solid var(--primary-bg);
            padding-bottom: 1mm;
            margin-top: 8mm;
            margin-bottom: 4mm;
        }
        .professional-template .main-content .job-title { font-size: 12pt; font-weight: bold; color: #333; }
        .professional-template .main-content .job-details { font-size: 10pt; color: #666; margin-bottom: 2mm; }
        .professional-template .main-content .job-description { font-size: 11pt; line-height: 1.5; }
        .professional-template .main-content .item { margin-bottom: 6mm; }

        /* === RESPONSIVIDADE === */
        @media (max-width: 768px) {
            .generator-container { padding: 20px; }
            .model-selector { flex-direction: column; }
            
            #menu-container nav ul { display: none; }
            .hamburger { display: flex; }
            .mobile-nav { display: flex; }
        }
        
        @media (min-width: 769px) {
            #menu-container nav ul { display: flex; }
            .hamburger { display: none; }
            .mobile-nav { display: none !important; }
        }
    </style>
</head>
<body>

    <header>
        <div class="nav-container">
            <a href="index.html" class="logo-area">
                <img src="favicon.png" alt="Logotipo ResolveFácil">
                <span>ResolveFácil</span>
            </a>
            <div id="menu-container"></div>
            <div class="hamburger" id="hamburger">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="mobile-nav" id="mobile-nav"></div>
    </header>

    <main>
        <div class="generator-container">
            <div class="generator-header">
                <h1>Gerador de Currículo ResolveFácil</h1>
                <p>Crie um currículo impactante em poucos passos. Preencha os campos e receba em seu e-mail.</p>
            </div>

            <div class="model-selector">
                <div class="model-option selected" id="select-simple" data-model="simple">
                    <i class="fas fa-file-alt"></i>
                    <h3>Simples</h3>
                    <p>Funcional e direto. Gratuito.</p>
                </div>
                <div class="model-option" id="select-professional" data-model="professional">
                    <i class="fas fa-user-tie"></i>
                    <h3>Profissional</h3>
                    <p>Com foto, links e design moderno. Pago.</p>
                </div>
            </div>

            <form id="cv-form">
                <section class="form-section">
                    <h2><i class="fas fa-user"></i>Dados Pessoais</h2>
                    <div class="form-group">
                        <label for="name">Nome Completo</label>
                        <input type="text" id="name" required>
                    </div>
                    <div class="form-group professional-only" style="margin-top: 20px;">
                        <label for="photo">Foto Profissional</label>
                        <label for="photo" id="photo-upload-wrapper">
                            <div id="photo-upload-placeholder">
                                <i class="fas fa-camera"></i>
                                <span>Clique para selecionar uma foto</span>
                            </div>
                            <img id="photo-preview" alt="Pré-visualização da foto">
                        </label>
                        <input type="file" id="photo" accept="image/*">
                    </div>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-phone"></i>Contato</h2>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="email">E-mail</label>
                            <input type="email" id="email" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Telefone</label>
                            <input type="tel" id="phone" required>
                        </div>
                        <div class="form-group professional-only">
                            <label for="address">Endereço (Ex: Cidade, Estado)</label>
                            <input type="text" id="address">
                        </div>
                        <div class="form-group professional-only">
                            <label for="linkedin">Perfil LinkedIn</label>
                            <input type="url" id="linkedin" placeholder="https://linkedin.com/in/seu-perfil">
                        </div>
                    </div>
                </section>
                
                <section class="form-section">
                    <h2><i class="fas fa-bullseye"></i>Resumo Profissional</h2>
                    <div class="form-group">
                        <label for="summary">Fale um pouco sobre sua carreira e objetivos.</label>
                        <textarea id="summary"></textarea>
                    </div>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-briefcase"></i>Experiência Profissional</h2>
                    <div id="experience-list"></div>
                    <button type="button" class="add-item-btn" id="add-experience-btn"><i class="fas fa-plus"></i> Adicionar Experiência</button>
                </section>
                
                <section class="form-section">
                    <h2><i class="fas fa-graduation-cap"></i>Formação Acadêmica</h2>
                    <div id="education-list"></div>
                    <button type="button" class="add-item-btn" id="add-education-btn"><i class="fas fa-plus"></i> Adicionar Formação</button>
                </section>

                <section class="form-section">
                    <h2><i class="fas fa-cogs"></i>Habilidades e Competências</h2>
                     <div class="form-group">
                        <label for="skills">Liste suas principais habilidades (separadas por vírgula).</label>
                        <input type="text" id="skills" placeholder="Ex: Comunicação, Pacote Office, Proatividade">
                    </div>
                </section>
                
                <section class="form-section professional-only">
                    <h2><i class="fas fa-language"></i>Idiomas</h2>
                    <div id="language-list"></div>
                    <button type="button" class="add-item-btn" id="add-language-btn"><i class="fas fa-plus"></i> Adicionar Idioma</button>
                </section>

            </form>

            <div class="generator-footer">
                <button class="generate-btn" id="generate-pdf-btn" type="button">
                    <i class="fas fa-eye"></i> Pré-visualizar e Enviar por E-mail
                </button>
            </div>
        </div>

        <section class="security-seals-section">
            <div class="security-seals-container">
                <img src="imagens/1-Selo-geguranca.png" alt="Selo de Segurança">
                <img src="imagens/2-Selo-geguranca.png" alt="Selo de Segurança LGPD">
                <img src="imagens/3-Selo-geguranca.png" alt="Selo de Segurança SSL">
            </div>
        </section>

        <div class="social-icons">
            <div class="social-icons-wrapper">
                <a href="https://www.instagram.com/resolvefacil.online" aria-label="Instagram">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="https://www.facebook.com/profile.php?id=61578208932996" aria-label="Facebook">
                    <i class="fab fa-facebook"></i>
                </a>
                <a href="https://wa.me/5592996029888?text=Ol%C3%A1%2C%20estou%20vindo%20atrav%C3%A9s%20do%20Site!%20Gostaria%20de%20um%20atendimento." aria-label="WhatsApp">
                    <i class="fab fa-whatsapp"></i>
                </a>
            </div>
        </div>
    </main>

    <footer>
        © 2025 ResolveFácil • Atendimento humanizado • Todos os direitos reservados
        <a href="politica-de-privacidade.html">Política de Privacidade</a>
    </footer>

    <div class="modal-overlay" id="email-modal">
        <div class="modal-content">
            <h3>Só mais um passo!</h3>
            <p>Para receber seu currículo gratuito, por favor, informe seu e-mail principal.</p>
            <input type="email" id="modal-email-input" placeholder="seu.email@exemplo.com" required>
            <div class="modal-actions">
                <button type="button" class="modal-btn" id="modal-cancel-btn">Cancelar</button>
                <button type="button" class="modal-btn" id="modal-confirm-btn">Confirmar e Pré-visualizar</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="preview-modal">
        <div class="modal-content">
            <h3>Pré-visualização do Currículo</h3>
            <div id="preview-area"></div>
            <div class="modal-actions">
                <button type="button" class="modal-btn" id="preview-cancel-btn">Voltar e Editar</button>
                <button type="button" class="modal-btn" id="preview-confirm-btn">Confirmar e Enviar por E-mail</button>
            </div>
        </div>
    </div>
    
    <div id="template-storage">
        <div id="simple-template-storage" class="pdf-template-base simple-template"></div>
        <div id="professional-template-storage" class="pdf-template-base professional-template"></div>
    </div>

    <script src="menu.js"></script>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let selectedModel = 'simple';
            let photoDataUrl = null;

            const form = document.getElementById('cv-form');
            const selectSimple = document.getElementById('select-simple');
            const selectProfessional = document.getElementById('select-professional');
            const professionalOnlyFields = document.querySelectorAll('.professional-only');
            const generateBtn = document.getElementById('generate-pdf-btn');
            
            const photoInput = document.getElementById('photo');
            const photoPreview = document.getElementById('photo-preview');
            const photoPlaceholder = document.getElementById('photo-upload-placeholder');

            const emailModal = document.getElementById('email-modal');
            const modalEmailInput = document.getElementById('modal-email-input');
            const modalConfirmBtn = document.getElementById('modal-confirm-btn');
            const modalCancelBtn = document.getElementById('modal-cancel-btn');

            const previewModal = document.getElementById('preview-modal');
            const previewArea = document.getElementById('preview-area');
            const previewConfirmBtn = document.getElementById('preview-confirm-btn');
            const previewCancelBtn = document.getElementById('preview-cancel-btn');
            
            let currentElementForPdf = null;

            function updateModelSelection() {
                if (selectedModel === 'simple') {
                    selectSimple.classList.add('selected');
                    selectProfessional.classList.remove('selected');
                    professionalOnlyFields.forEach(el => el.style.display = 'none');
                } else {
                    selectSimple.classList.remove('selected');
                    selectProfessional.classList.add('selected');
                    professionalOnlyFields.forEach(el => el.style.display = 'block');
                }
            }

            selectSimple.addEventListener('click', () => {
                selectedModel = 'simple';
                updateModelSelection();
            });

            selectProfessional.addEventListener('click', () => {
                selectedModel = 'professional';
                updateModelSelection();
            });

            photoInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        photoDataUrl = e.target.result;
                        photoPreview.src = photoDataUrl;
                        photoPreview.style.display = 'block';
                        photoPlaceholder.style.display = 'none';
                    };
                    reader.readAsDataURL(file);
                }
            });

            function setupDynamicSection(addBtnId, listId, templateFunction) {
                const addBtn = document.getElementById(addBtnId);
                const listContainer = document.getElementById(listId);

                addBtn.addEventListener('click', () => {
                    const newItem = document.createElement('div');
                    newItem.classList.add('dynamic-item');
                    newItem.innerHTML = templateFunction();
                    
                    newItem.querySelector('.remove-item-btn').addEventListener('click', () => {
                        newItem.remove();
                    });
                    
                    listContainer.appendChild(newItem);
                });
            }

            const experienceTemplate = () => `
                <button type="button" class="remove-item-btn">&times;</button>
                <div class="form-grid">
                    <div class="form-group"><label>Cargo</label><input type="text" class="exp-job-title"></div>
                    <div class="form-group"><label>Empresa</label><input type="text" class="exp-company"></div>
                    <div class="form-group"><label>Período (Ex: Jan 2020 - Dez 2022)</label><input type="text" class="exp-period"></div>
                </div>
                <div class="form-group" style="margin-top: 15px;"><label>Descrição das atividades</label><textarea class="exp-description"></textarea></div>
            `;
            
            const educationTemplate = () => `
                <button type="button" class="remove-item-btn">&times;</button>
                <div class="form-grid">
                    <div class="form-group"><label>Curso/Formação</label><input type="text" class="edu-course"></div>
                    <div class="form-group"><label>Instituição</label><input type="text" class="edu-institution"></div>
                    <div class="form-group"><label>Período</label><input type="text" class="edu-period"></div>
                </div>
            `;
            
            const languageTemplate = () => `
                 <button type="button" class="remove-item-btn">&times;</button>
                 <div class="form-grid">
                    <div class="form-group"><label>Idioma</label><input type="text" class="lang-name" placeholder="Ex: Inglês"></div>
                    <div class="form-group"><label>Nível</label><input type="text" class="lang-level" placeholder="Ex: Avançado"></div>
                </div>
            `;
            
            setupDynamicSection('add-experience-btn', 'experience-list', experienceTemplate);
            setupDynamicSection('add-education-btn', 'education-list', educationTemplate);
            setupDynamicSection('add-language-btn', 'language-list', languageTemplate);

            generateBtn.addEventListener('click', () => {
                if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                }
                
                if (selectedModel === 'simple') {
                    emailModal.style.display = 'flex';
                } else {
                    alert('A versão Profissional será integrada com um sistema de pagamento. Por enquanto, a demonstração enviará o currículo por e-mail.');
                    showPreview();
                }
            });

            modalConfirmBtn.addEventListener('click', () => {
                if (modalEmailInput.checkValidity()) {
                    emailModal.style.display = 'none';
                    showPreview();
                } else {
                    modalEmailInput.reportValidity();
                }
            });

            modalCancelBtn.addEventListener('click', () => {
                emailModal.style.display = 'none';
            });
            
            previewCancelBtn.addEventListener('click', () => {
                previewModal.style.display = 'none';
                previewArea.innerHTML = ''; 
                currentElementForPdf = null;
            });

            function showPreview() {
                const data = collectFormData();
                const templateClass = selectedModel === 'simple' ? 'simple-template' : 'professional-template';
                
                currentElementForPdf = document.createElement('div');
                currentElementForPdf.classList.add('pdf-template-base', templateClass);
                populateTemplate(currentElementForPdf, data);
                
                previewArea.innerHTML = ''; 
                previewArea.appendChild(currentElementForPdf);
                previewModal.style.display = 'flex';
            }

            async function sendResumeByEmail() {
                if (!currentElementForPdf) {
                    alert("Nenhuma pré-visualização disponível para enviar.");
                    return;
                }

                const userEmail = document.getElementById('modal-email-input').value || document.getElementById('email').value;
                const userName = document.getElementById('name').value || "Candidato(a)";

                if (!userEmail) {
                    alert("Por favor, informe um e-mail válido.");
                    return;
                }
                
                const resumeHtml = currentElementForPdf.outerHTML;

                const previewConfirmBtn = document.getElementById('preview-confirm-btn');
                previewConfirmBtn.disabled = true;
                previewConfirmBtn.innerText = 'Enviando...';
                generateBtn.disabled = true;
                generateBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Enviando...';

                try {
                    const response = await fetch('/.netlify/functions/enviar-curriculo', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            userEmail: userEmail,
                            userName: userName,
                            resumeHtml: resumeHtml
                        })
                    });

                    if (!response.ok) {
                        const errorResult = await response.json();
                        throw new Error(errorResult.message || 'Falha na comunicação com o servidor.');
                    }

                    alert('Sucesso! Seu currículo foi enviado para o seu e-mail.');
                    window.location.reload();

                } catch (error) {
                    console.error("Erro ao enviar e-mail:", error);
                    alert("Ocorreu um erro ao enviar seu currículo. Por favor, tente novamente. Detalhes: " + error.message);
                } finally {
                    previewConfirmBtn.disabled = false;
                    previewConfirmBtn.innerText = 'Confirmar e Enviar por E-mail';
                    generateBtn.disabled = false;
                    generateBtn.innerHTML = '<i class="fas fa-eye"></i> Pré-visualizar e Enviar por E-mail';
                }
            }
            
            previewConfirmBtn.addEventListener('click', sendResumeByEmail);


            function populateTemplate(container, data) {
                if (selectedModel === 'simple') {
                    container.innerHTML = `
                        <div class="header">
                            <div class="name">${data.name}</div>
                            <div class="contact-info">${data.phone} | ${data.email}</div>
                        </div>
                        <div class="section">
                            <div class="section-title">Resumo Profissional</div>
                            <div class="content">${data.summary.replace(/\n/g, '<br>')}</div>
                        </div>
                        <div class="section">
                            <div class="section-title">Experiência Profissional</div>
                            ${data.experiences.map(exp => `
                                <div class="item">
                                    <div class="job-title">${exp.jobTitle}</div>
                                    <div class="job-details">${exp.company} | ${exp.period}</div>
                                    <div class="job-description">${exp.description}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="section">
                            <div class="section-title">Formação Acadêmica</div>
                            ${data.educations.map(edu => `
                                <div class="item">
                                    <div class="job-title">${edu.course}</div>
                                    <div class="job-details">${edu.institution} | ${edu.period}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div class="section">
                            <div class="section-title">Habilidades</div>
                            <div class="skills-list">${data.skills.join(' &bull; ')}</div>
                        </div>
                    `;
                } else { // Professional
                    container.innerHTML = `
                        <div class="sidebar">
                            ${data.photo ? `<img src="${data.photo}" class="profile-photo" alt="Foto de perfil">` : ''}
                            <div class="section">
                                <div class="section-title">Contato</div>
                                <div class="contact-item"><i class="fas fa-phone"></i> <a href="tel:${data.phone}">${data.phone}</a></div>
                                <div class="contact-item"><i class="fas fa-envelope"></i> <a href="mailto:${data.email}">${data.email}</a></div>
                                ${data.address ? `<div class="contact-item"><i class="fas fa-map-marker-alt"></i> ${data.address}</div>` : ''}
                                ${data.linkedin ? `<div class="contact-item"><i class="fab fa-linkedin"></i> <a href="${data.linkedin}" target="_blank">LinkedIn</a></div>` : ''}
                            </div>
                            <div class="section">
                                <div class="section-title">Habilidades</div>
                                ${data.skills.map(skill => `<div class="skill-item">${skill}</div>`).join('')}
                            </div>
                            ${data.languages.length > 0 ? `
                            <div class="section">
                                <div class="section-title">Idiomas</div>
                                ${data.languages.map(lang => `<div class="lang-item"><strong>${lang.name}:</strong> ${lang.level}</div>`).join('')}
                            </div>` : ''}
                        </div>
                        <div class="main-content">
                            <div class="name">${data.name}</div>
                            <div class="section">
                                <div class="section-title">Resumo Profissional</div>
                                <div class="job-description">${data.summary.replace(/\n/g, '<br>')}</div>
                            </div>
                             <div class="section">
                                <div class="section-title">Experiência Profissional</div>
                                ${data.experiences.map(exp => `
                                    <div class="item">
                                        <div class="job-title">${exp.jobTitle}</div>
                                        <div class="job-details">${exp.company} | ${exp.period}</div>
                                        <div class="job-description">${exp.description}</div>
                                    </div>
                                `).join('')}
                            </div>
                            <div class="section">
                                <div class="section-title">Formação Acadêmica</div>
                                ${data.educations.map(edu => `
                                    <div class="item">
                                        <div class="job-title">${edu.course}</div>
                                        <div class="job-details">${edu.institution} | ${edu.period}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }

            function collectFormData() {
                const data = {
                    name: document.getElementById('name').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    address: document.getElementById('address').value,
                    linkedin: document.getElementById('linkedin').value,
                    summary: document.getElementById('summary').value,
                    photo: photoDataUrl,
                    skills: document.getElementById('skills').value.split(',').map(s => s.trim()).filter(s => s),
                    experiences: [],
                    educations: [],
                    languages: []
                };

                document.querySelectorAll('#experience-list .dynamic-item').forEach(item => {
                    data.experiences.push({
                        jobTitle: item.querySelector('.exp-job-title').value,
                        company: item.querySelector('.exp-company').value,
                        period: item.querySelector('.exp-period').value,
                        description: item.querySelector('.exp-description').value.replace(/\n/g, '<br>')
                    });
                });

                document.querySelectorAll('#education-list .dynamic-item').forEach(item => {
                    data.educations.push({
                        course: item.querySelector('.edu-course').value,
                        institution: item.querySelector('.edu-institution').value,
                        period: item.querySelector('.edu-period').value
                    });
                });
                
                document.querySelectorAll('#language-list .dynamic-item').forEach(item => {
                    data.languages.push({
                        name: item.querySelector('.lang-name').value,
                        level: item.querySelector('.lang-level').value
                    });
                });

                return data;
            }
            
            updateModelSelection();
            document.getElementById('add-experience-btn').click();
            document.getElementById('add-education-btn').click();
        });
    </script>
</body>
</html>
